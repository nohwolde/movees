(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{14986:function(e,l,t){Promise.resolve().then(t.bind(t,93273)),Promise.resolve().then(t.bind(t,24380)),Promise.resolve().then(t.t.bind(t,58178,23)),Promise.resolve().then(t.t.bind(t,58877,23)),Promise.resolve().then(t.bind(t,19354)),Promise.resolve().then(t.bind(t,37831)),Promise.resolve().then(t.bind(t,38462)),Promise.resolve().then(t.bind(t,63901)),Promise.resolve().then(t.bind(t,39311))},56363:function(e,l,t){"use strict";var i=t(57437),o=t(78077);l.Z=e=>{let{children:l,className:t}=e;return(0,i.jsx)("div",{className:(0,o.m)("\n        bg-neutral-900 \n        rounded-lg \n        h-fit \n        w-full\n        ",t),children:l})}},46066:function(e,l,t){"use strict";var i=t(57437),o=t(66648),r=t(57771);l.Z=e=>{let{data:l,image:t,onClick:s}=e;return(0,i.jsxs)("div",{onClick:()=>s(l.id),className:" relative  group  flex  flex-col  items-center  justify-center  rounded-md  overflow-hidden  gap-x-4  bg-neutral-400/5  cursor-pointer  hover:bg-neutral-400/10  transition  p-3 ",children:[(0,i.jsx)("div",{className:" relative  aspect-square  w-full h-full  rounded-md  overflow-hidden ",children:(0,i.jsx)(o.default,{className:"object-cover",src:t||r,fill:!0,alt:"Image"})}),(0,i.jsxs)("div",{className:"flex flex-col items-start w-full pt-4 gap-y-1",children:[(0,i.jsx)("p",{className:"font-semibold truncate w-full",children:l.title}),(0,i.jsxs)("p",{className:" text-neutral-400  text-sm  pb-4  w-full  truncate ",children:["By ",l.artist]})]})]})}},1433:function(e,l,t){"use strict";var i=t(57437),o=t(66648),r=t(57771);l.Z=e=>{let{playlist:l,image:t,onClick:s}=e;return(0,i.jsxs)("div",{onClick:s,className:" flex  items-center  gap-x-3  cursor-pointer  hover:bg-neutral-800/50  w-full  p-2  rounded-md ",children:[(0,i.jsx)("div",{className:" relative  rounded-md  min-h-[48px]  min-w-[48px]  overflow-hidden ",children:(0,i.jsx)(o.default,{fill:!0,src:t||r,alt:"ArtistItem",className:"object-cover"})}),(0,i.jsxs)("div",{className:"flex flex-col gap-y-1 overflow-hidden",children:[(0,i.jsx)("p",{className:"text-white truncate",children:l.name}),(0,i.jsx)("p",{className:"text-neutral-400 text-sm truncate",children:l.subtitle})]})]},l.id)}},24380:function(e,l,t){"use strict";t.d(l,{default:function(){return N}});var i=t(57437),o=t(30505),r=t(93850),s=t(78077),a=t(16463),n=t(43765),d=t(87138),u=t(9772),c=t.n(u),m=e=>{let{label:l,active:t,href:o,name:r}=e;return(0,i.jsx)(d.default,{href:o,children:(0,i.jsxs)("div",{className:"group select-none cursor-pointer mt-2 flex flex-row items-center mobile:flex-col tablet:flex-col mini-laptop:w-full mini-laptop:mt-6 mobile:mt-0 tablet:mt-0 mobile:mx-8 tablet:mx-10",children:[(0,i.jsx)("i",{className:c()(t?"icon-".concat(r.toLowerCase(),"_filled mobile:text-[20px]"):"icon-".concat(r.toLowerCase()," mobile:text-[20px] text-white"),{"opacity-70 group-hover:opacity-100":!t},"mr-4 mobile:mr-0 tablet:mr-0 mobile:mb-1 tablet:mb-1")}),(0,i.jsx)("p",{className:"truncate w-100",children:l})]})})},v=t(56363),f=t(61379),h=t(96300),p=t(89362),g=t(56480),x=t(55598),y=t(1433),b=e=>{let{songs:l,spotify:t,soundcloud:o,youtube:r}=e,s=(0,a.useRouter)(),n=(0,a.usePathname)(),{user:d,subscription:u}=(0,p.aF)();return(0,h.Z)(),(0,g.Z)(),(0,x.Z)(),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between px-5 pt-4",children:[(0,i.jsx)("div",{className:"inline-flex items-center gap-x-2 text-neutral-400 cursor-pointer hover:text-white",children:(0,i.jsx)(m,{name:"library",label:"Your Library",href:"/",active:"/library"===n})}),(0,i.jsx)(f.Lfi,{size:20,className:" mt-2 text-neutral-400  cursor-pointer  hover:text-white  transition "})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-y-2 mt-4 px-3",children:[t.length>0&&(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("p",{className:"text-green-500  text-lg font-bold truncate hover:cursor-pointer",onClick:()=>s.push("/spot"),children:"Spotify Playlists"}),t.map(e=>(0,i.jsx)(y.Z,{onClick:()=>s.push("/spot/playlist?id=".concat(e.id)),playlist:{...e,id:e.href,subtitle:""},image:e.image},e.id))]}),o.length>0&&(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("p",{className:"text-orange-500 text-lg font-bold truncate hover:cursor-pointer",onClick:()=>s.push("/sc"),children:"Soundcloud Playlists"}),o.map(e=>(0,i.jsx)(y.Z,{onClick:()=>s.push("/sc/playlist?id=".concat(e.id)),playlist:{...e,subtitle:""},image:e.image},e.id))]}),r.length>0&&(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)("p",{className:"text-rose-500 text-lg font-bold truncate hover:cursor-pointer",onClick:()=>s.push("/yt"),children:"Youtube Playlists"}),r.map(e=>(0,i.jsx)(y.Z,{onClick:()=>s.push("/yt/playlist?id=".concat(e.id)),playlist:{...e,subtitle:""},image:e.image},e.id))]})]})]})},j=t(2265),w=t(81634),N=e=>{let{children:l,songs:t}=e,d=(0,a.usePathname)();(0,n.Z)();let{spotPlaylists:u,ytPlaylists:c,scPlaylists:f}=(0,w.Oz)();(0,j.useMemo)(()=>[{icon:o.g3P,label:"Home",active:"/search"!==d,href:"/"},{icon:r.Goc,label:"Search",href:"/search",active:"/search"===d}],[d]);let[h,p]=(0,j.useState)(!0);return(0,i.jsxs)("div",{className:(0,s.m)(d.startsWith("/watch")?"\n        flex\n        h-[calc(100%-80px)]\n        ":"\n        flex\n        h-[calc(100%-80px)]\n        w-full\n        "),children:[h&&(0,i.jsxs)("div",{className:" hidden  md:flex  flex-col  gap-y-2  bg-black  h-full  w-[300px]  p-2 ",children:[(0,i.jsx)(v.Z,{children:(0,i.jsxs)("div",{className:"flex flex-col gap-y-4 px-5 py-4",children:[(0,i.jsx)(m,{name:"home",label:"Home",href:"/",active:"/"===d}),(0,i.jsx)(m,{name:"search",label:"Search",href:"/search",active:"/search"===d})]})}),(0,i.jsx)(v.Z,{className:"overflow-y-auto h-full",children:(0,i.jsx)(b,{spotify:u||[],soundcloud:f||[],youtube:c||[]})})]}),!d.startsWith("/watch")&&(0,i.jsx)("main",{className:"h-full w-full flex-1 overflow-y-auto py-2",children:l})]})}},47764:function(e,l,t){"use strict";t.d(l,{UK:function(){return r},xe:function(){return s},xq:function(){return o}});var i=t(39099);let o=(0,i.Ue)((e,l)=>({user:null,setUser:l=>e({user:l}),username:"",setUsername:l=>e({username:l}),name:"",setName:l=>e({name:l}),image:"",setImage:l=>e({image:l}),playlists:null,setPlaylists:l=>e({playlists:l}),addPlaylist:l=>e(e=>({playlists:e.playlists?[...e.playlists,l]:[l]})),getPlaylist:e=>{let{playlists:t}=l();return t?t.find(l=>l.id==="/playlist/"+e):null}})),r=(0,i.Ue)((e,l)=>({user:null,setUser:l=>e({user:l}),username:"",setUsername:l=>e({username:l}),name:"",setName:l=>e({name:l}),image:"",setImage:l=>e({image:l}),playlists:null,setPlaylists:l=>e({playlists:l}),addPlaylist:l=>e(e=>({playlists:e.playlists?[...e.playlists,l]:[l]})),getPlaylist:e=>{let{playlists:t}=l();return t?t.find(l=>l.id===e):null}})),s=(0,i.Ue)((e,l)=>({user:null,setUser:l=>e({user:l}),username:"",setUsername:l=>e({username:l}),name:"",setName:l=>e({name:l}),image:"",setImage:l=>e({image:l}),playlists:null,setPlaylists:l=>e({playlists:l}),addPlaylist:l=>e(e=>({playlists:e.playlists?[...e.playlists,l]:[l]})),getPlaylist:e=>{let{playlists:t}=l();return t?t.find(l=>l.id===e):null}}))},55598:function(e,l,t){"use strict";let i=(0,t(39099).Ue)(e=>({isOpen:!1,onOpen:()=>e({isOpen:!0}),onClose:()=>e({isOpen:!1})}));l.Z=i},96300:function(e,l,t){"use strict";let i=(0,t(39099).Ue)(e=>({isOpen:!1,onOpen:()=>e({isOpen:!0}),onClose:()=>e({isOpen:!1})}));l.Z=i},19354:function(e,l,t){"use strict";let i;t.d(l,{default:function(){return ee}});var o=t(57437),r=t(2265),s=t(82035),a=t(75361),n=t(34728),d=t(16463),u=t(56480),c=t(37896),m=t(8603),v=e=>{let{isOpen:l,onChange:t,title:i,description:r,children:s}=e;return(0,o.jsx)(c.fC,{open:l,defaultOpen:l,onOpenChange:t,children:(0,o.jsxs)(c.h_,{children:[(0,o.jsx)(c.aV,{className:" bg-neutral-900/90 fixed  inset-0 "}),(0,o.jsxs)(c.VY,{className:" fixed  drop-shadow-md  border  border-neutral-700  top-[50%]  left-[50%]  max-h-full  h-full  md:h-auto  md:max-h-[85vh]  w-full  md:w-[90vw]  md:max-w-[450px]  translate-x-[-50%]  translate-y-[-50%]  rounded-md  bg-neutral-800  p-[25px]  focus:outline-none overflow-y-auto ",children:[(0,o.jsx)(c.Dx,{className:" text-xl  text-center  font-bold  mb-4 ",children:i}),(0,o.jsx)(c.dk,{className:" mb-5  text-sm  leading-normal  text-center ",children:r}),(0,o.jsx)("div",{children:s}),(0,o.jsx)(c.x8,{asChild:!0,children:(0,o.jsx)("button",{className:" text-neutral-400  hover:text-white  absolute  top-[10px]  right-[10px]  inline-flex  h-[25px]  w-[25px]  appearance-none  items-center  justify-center  rounded-full  focus:outline-none ","aria-label":"Close",children:(0,o.jsx)(m.QAE,{})})})]})]})})},f=()=>{let{session:e}=(0,n.useSessionContext)(),l=(0,d.useRouter)(),{onClose:t,isOpen:i}=(0,u.Z)(),c=(0,n.useSupabaseClient)();return(0,r.useEffect)(()=>{e&&(l.refresh(),t())},[e,l,t]),(0,o.jsx)(v,{title:"Welcome back",description:"Login to your account.",isOpen:i,onChange:e=>{e||t()},children:(0,o.jsx)(s.gx,{supabaseClient:c,providers:["google","apple"],magicLink:!0,appearance:{theme:a.rD,variables:{default:{colors:{brand:"#000066",brandAccent:"#389fff"}}}},theme:"dark"})})},h=t(12947),p=t(78077),g=t(81634),x=t(1433),y=t(66648),b=t(60370),j=t(17005),w=t(88726),N=t(61379),_=()=>{var e;let{session:l}=(0,n.useSessionContext)(),t=(0,d.useRouter)(),{onClose:i,isOpen:s,song:a}=(0,h.Z)(),{spotPlaylists:u,ytPlaylists:c,scPlaylists:m}=(0,g.Oz)(),{addToFront:f,addToQueue:_}=(0,g.nP)(),[S,C]=(0,r.useState)("Spotify"),k=(0,n.useSupabaseClient)();(0,r.useEffect)(()=>{l&&(t.refresh(),i())},[l,t,i]);let P=async e=>{let{data:l,error:t}=await k.from("songs").select().eq("id",a.id);if(t&&console.log(t),l&&0===l.length){let{data:e,error:l}=await k.from("songs").insert(a);l&&console.log(l),console.log(e)}let{data:i,error:o}=await k.from("playlists_songs").select("*").filter("playlistId","eq",e);if(o){console.error("Error getting current songs:",o);return}let r=i.length>0?i.length+1:1,{error:s}=await k.from("playlists_songs").insert({playlistId:e,song_id:a.id,song_order:r});s?(console.log(s),w.Am.error("Failed to add to playlist")):w.Am.success("Added to Playlist")},E=()=>{var e,l,t,i,o;console.log("adding to Front of Queue",a),"Soundcloud"===a.platform?f({id:null==a?void 0:a.id,user:[null==a?void 0:a.author],title:null==a?void 0:a.name,artwork_url:null==a?void 0:a.image,track_authorization:null==a?void 0:null===(e=a.media)||void 0===e?void 0:e.track_authorization,media:null==a?void 0:a.media,platform:"Soundcloud"}):"Youtube"===a.platform?f({id:null==a?void 0:a.id,author:null==a?void 0:a.author,title:{text:null==a?void 0:a.name},thumbnails:[{url:null==a?void 0:a.image}],platform:"Youtube"}):f({id:null===(l=a.yt)||void 0===l?void 0:l.id,author:null===(t=a.yt)||void 0===t?void 0:t.author,title:{text:null===(i=a.yt)||void 0===i?void 0:i.name},thumbnails:[{url:null===(o=a.yt)||void 0===o?void 0:o.image}],platform:"Youtube"})},Z=()=>{var e,l,t,i,o;console.log("adding to End of Queue",a),"Soundcloud"===a.platform?_({id:null==a?void 0:a.id,user:[null==a?void 0:a.author],title:null==a?void 0:a.name,artwork_url:null==a?void 0:a.image,track_authorization:null==a?void 0:null===(e=a.media)||void 0===e?void 0:e.track_authorization,media:null==a?void 0:a.media,platform:"Soundcloud"}):"Youtube"===a.platform?_({id:null==a?void 0:a.id,author:null==a?void 0:a.author,title:{text:null==a?void 0:a.name},thumbnails:[{url:null==a?void 0:a.image}],platform:"Youtube"}):_({id:null===(l=a.yt)||void 0===l?void 0:l.id,author:null===(t=a.yt)||void 0===t?void 0:t.author,title:{text:null===(i=a.yt)||void 0===i?void 0:i.name},thumbnails:[{url:null===(o=a.yt)||void 0===o?void 0:o.image}],platform:"Youtube"})};return(0,o.jsx)(v,{title:"Add to Queue or Playlist",description:"",isOpen:s,onChange:e=>{e||i()},children:(0,o.jsxs)("div",{className:(0,p.m)("overflow-y-scroll"),children:[(0,o.jsx)("div",{className:(0,p.m)("flex flex-col items-center justify-center"),children:(0,o.jsx)("div",{className:(0,p.m)("flex flex-col items-center justify-center"),children:(0,o.jsxs)("div",{className:(0,p.m)("flex flex-col items-center justify-center bg-neutral-700 p-2 rounded-md"),children:[a&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("img",{src:a.image,alt:a.name,className:(0,p.m)("w-auto h-32 rounded-md")}),(0,o.jsx)("h2",{className:(0,p.m)("text-lg font-bold mt-4"),children:a.name}),(0,o.jsx)("p",{className:(0,p.m)("text-sm text-gray-200"),children:null===(e=a.author)||void 0===e?void 0:e.username})]}),(0,o.jsx)("h2",{className:(0,p.m)("text-2xl text-center font-bold mt-4"),children:"Queue"}),(0,o.jsxs)("div",{className:(0,p.m)("flex flex-row items-center justify-center"),children:[(0,o.jsx)("div",{className:" transition  opacity-100  rounded-md  justify-center  bg-cyan-500  p-4 drop-shadow-md  group-hover:opacity-100  group-hover:translate-y-0 hover:scale-110  ",onClick:e=>{null==e||e.stopPropagation(),E(),w.Am.success("Added to Queue"),i()},children:(0,o.jsx)(y.default,{className:"object-contain",src:b.default,alt:"Image",width:55,height:55})}),(0,o.jsx)("div",{className:" transition  opacity-100  rounded-md flex  items-center  justify-center  bg-blue-500 p-4 drop-shadow-md  group-hover:opacity-100  hover:scale-110 ",onClick:e=>{null==e||e.stopPropagation(),Z(),w.Am.success("Added to Queue"),i()},children:(0,o.jsx)(y.default,{className:"object-contain",src:j.default,alt:"Image",width:55,height:55})})]})]})})}),(0,o.jsx)("h2",{className:(0,p.m)("text-2xl text-center font-bold mt-4 "),children:"Playlist"}),(0,o.jsxs)("div",{className:"flex w-full pt- p-4 bg-neutral-800 rounded-full",children:[(0,o.jsx)("div",{className:"flex-1 text-center hover:cursor-pointer ".concat("Spotify"===S?"text-green-500 text-2xl font-semibold":"text-gray-400 hover:text-xl font-semibold"),onClick:()=>C("Spotify"),children:"Spotify"}),(0,o.jsx)("div",{className:"flex-1 text-center hover:cursor-pointer ".concat("Youtube"===S?"text-rose-500 text-2xl font-semibold":"text-gray-400 hover:text-xl font-semibold"),onClick:()=>C("Youtube"),children:"YouTube"}),(0,o.jsx)("div",{className:"flex-1 text-center hover:cursor-pointer ".concat("Soundcloud"===S?"text-orange-500 text-2xl font-semibold":"text-gray-400 hover:text-xl font-semibold"),onClick:()=>C("Soundcloud"),children:"Soundcloud"})]}),(0,o.jsx)("div",{className:"flex flex-col bg-neutral-900 rounded-lg overflow-y-scroll max-h-[300px]",children:(0,o.jsx)("div",{className:"pr-4",children:"Spotify"===S&&u&&u.map(e=>(0,o.jsxs)("div",{className:"flex flex-1 w-full hover:bg-neutral-700",children:[(0,o.jsx)("div",{className:"flex-grow truncate",children:(0,o.jsx)(x.Z,{onClick:()=>{},playlist:{...e,subtitle:""},image:e.image},e.id)}),(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)(N.Lfi,{onClick:()=>P(e.id),size:30,className:" items-end m-2 mt-4 text-neutral-400  cursor-pointer  hover:text-white  transition "})})]},e.id))})}),(0,o.jsx)("div",{className:"flex flex-col bg-neutral-900 rounded-lg overflow-y-auto max-h-[300px]",children:(0,o.jsx)("div",{className:"pr-4",children:"Youtube"===S&&c&&c.map(e=>(0,o.jsxs)("div",{className:"flex flex-1 w-full hover:bg-neutral-700",children:[(0,o.jsx)("div",{className:"flex-grow truncate",children:(0,o.jsx)(x.Z,{onClick:()=>{},playlist:{...e,subtitle:""},image:e.image},e.id)}),(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)(N.Lfi,{onClick:()=>P(e.id),size:30,className:" items-end m-2 mt-4 text-neutral-400  cursor-pointer  hover:text-white  transition "})})]},e.id))})}),(0,o.jsx)("div",{className:"flex flex-col bg-neutral-900 rounded-lg overflow-y-auto max-h-[300px]",children:(0,o.jsx)("div",{className:"pr-4",children:"Soundcloud"===S&&m&&m.map(e=>(0,o.jsxs)("div",{className:"flex flex-1 w-full hover:bg-neutral-700 ",children:[(0,o.jsx)("div",{className:"flex-grow truncate",children:(0,o.jsx)(x.Z,{onClick:()=>{},playlist:{...e,subtitle:""},image:e.image},e.id)}),(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)(N.Lfi,{onClick:()=>P(e.id),size:30,className:" items-end m-2 mt-4 text-neutral-400  cursor-pointer  hover:text-white  transition "})})]},e.id))})})]})})},S=t(55598),C=t(89362),k=t(80910),P=t(92512);let E=()=>(!i&&(i=(0,P.J)("pk_test_51NLpuHGAYJpOUX8uMm6qT08ZaPK2ZaXVGOrSYLwBfXHRHzbU5CgiAVD1jvQVo48phsHK57Tf3jTD941wUVabYPVY00ipl15Vzy")),i);var Z=t(99787);let Y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency,minimumFractionDigits:0}).format(((null==e?void 0:e.unit_amount)||0)/100);var O=e=>{let{products:l}=e,t=(0,S.Z)(),{user:i,isLoading:s,subscription:a}=(0,C.aF)(),[n,d]=(0,r.useState)(),u=async e=>{if(d(e.id),!i)return d(void 0),w.Am.error("Must be logged in");if(a)return d(void 0),(0,w.Am)("Already subscribed");try{let{sessionId:l}=await (0,k.qC)({url:"/api/create-checkout-session",data:{price:e}}),t=await E();null==t||t.redirectToCheckout({sessionId:l})}catch(e){return w.Am.error(null==e?void 0:e.message)}finally{d(void 0)}},c=(0,o.jsx)("div",{className:"text-center",children:"No products available."});return l.length&&(c=(0,o.jsx)("div",{children:l.map(e=>{var l;return(null===(l=e.prices)||void 0===l?void 0:l.length)?e.prices.map(e=>(0,o.jsx)(Z.Z,{onClick:()=>u(e),disabled:s||e.id===n,className:"mb-4",children:"Subscribe for ".concat(Y(e)," a ").concat(e.interval)},e.id)):(0,o.jsx)("div",{children:"No prices available"},e.id)})})),a&&(c=(0,o.jsx)("div",{className:"text-center",children:"Already subscribed."})),(0,o.jsx)(v,{title:"Only for premium users",description:"Listen to music with Beatbytes Premium",isOpen:t.isOpen,onChange:e=>{e||t.onClose()},children:c})},I=t(89985),A=t.n(I),U=t(39343),q=t(96300),z=t(23338),L=()=>{let[e,l]=(0,r.useState)(!1),t=(0,q.Z)(),i=(0,n.useSupabaseClient)(),{user:s}=(0,C.aF)(),a=(0,d.useRouter)(),{register:u,handleSubmit:c,reset:m}=(0,U.cI)({defaultValues:{author:"",title:"",song:null,image:null}}),f=async e=>{try{var o,r;l(!0);let n=null===(o=e.image)||void 0===o?void 0:o[0],d=null===(r=e.song)||void 0===r?void 0:r[0];if(!n||!d||!s){w.Am.error("Missing fields");return}let u=A()(),{data:c,error:v}=await i.storage.from("songs").upload("song-".concat(e.title,"-").concat(u),d,{cacheControl:"3600",upsert:!1});if(v)return l(!1),w.Am.error("Failed song upload");let{data:f,error:h}=await i.storage.from("images").upload("image-".concat(e.title,"-").concat(u),n,{cacheControl:"3600",upsert:!1});if(h)return l(!1),w.Am.error("Failed image upload");let{error:p}=await i.from("songs").insert({user_id:s.id,title:e.title,author:e.author,image_path:f.path,song_path:c.path});if(p)return w.Am.error(p.message);a.refresh(),l(!1),w.Am.success("Song created!"),m(),t.onClose()}catch(e){w.Am.error("Something went wrong")}finally{l(!1)}};return(0,o.jsx)(v,{title:"Add a song",description:"Upload an mp3 file",isOpen:t.isOpen,onChange:e=>{e||(m(),t.onClose())},children:(0,o.jsxs)("form",{onSubmit:c(f),className:"flex flex-col gap-y-4",children:[(0,o.jsx)(z.Z,{id:"title",disabled:e,...u("title",{required:!0}),placeholder:"Song title"}),(0,o.jsx)(z.Z,{id:"author",disabled:e,...u("author",{required:!0}),placeholder:"Song author"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"pb-1",children:"Select a song file"}),(0,o.jsx)(z.Z,{placeholder:"test",disabled:e,type:"file",accept:".mp3",id:"song",...u("song",{required:!0})})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"pb-1",children:"Select an image"}),(0,o.jsx)(z.Z,{placeholder:"test",disabled:e,type:"file",accept:"image/*",id:"image",...u("image",{required:!0})})]}),(0,o.jsx)(Z.Z,{disabled:e,type:"submit",children:"Create"})]})})},F=t(57771),V=t(84238),K=t(46066),Q=e=>{let{profile:l,onClose:t,isOpen:i,platform:s,handleSearchUser:a,handleGetPlaylists:u}=e,[c,m]=(0,r.useState)(1),[f,h]=(0,r.useState)(null),[x,b]=(0,r.useState)(null),[j,N]=(0,r.useState)(""),[_,S]=(0,r.useState)(""),{session:C}=(0,n.useSessionContext)(),k=(0,d.useRouter)();(0,n.useSupabaseClient)();let{spotPlaylists:P,setSpotPlaylists:E}=(0,g.Oz)();return(0,r.useEffect)(()=>{C&&(k.refresh(),t())},[C,k,t]),(0,r.useEffect)(()=>{""!==_&&a(_).then(e=>{e&&h(e)})},[_]),(0,r.useEffect)(()=>{f&&(console.log(f),l.setUsername(f.username),l.setImage(f.photo),l.setName(f.name),k.push("Spotify"===s?"/spot":"Youtube"===s?"/yt":"/sc"))},[f]),(0,o.jsx)(v,{title:"Load your ".concat(s," playlists"),description:1===c?"Type your account username to load your playlists.":"",isOpen:i,onChange:e=>{e||t()},children:(0,o.jsxs)("div",{className:(0,p.m)("flex flex-col items-center justify-center"),children:[1===c&&(0,o.jsxs)("div",{className:(0,p.m)("flex flex-row items-center justify-center p-3"),children:[(0,o.jsx)(z.Z,{placeholder:"What's your ".concat(s," Username?"),value:j,onChange:e=>N(e.target.value),className:"w-[300px]",onKeyDown:e=>"Enter"===e.key&&""!==j&&S(j)}),(0,o.jsx)(Z.Z,{className:(0,p.m)("w-[100px] ".concat("Spotify"===s?"bg-green-500":"Youtube"===s?"bg-red-500":"bg-orange-500"," ").concat("Spotify"===s?"hover:bg-green-600":"Youtube"===s?"hover:bg-red-600":"hover:bg-orange-600")),onClick:()=>a(j).then(e=>{e?h(e):h(null)}),children:"Search"})]}),f?(0,o.jsxs)("div",{className:(0,p.m)("flex flex-row items-center justify-center m-2 p-2 bg-gray-700 rounded-sm"),children:[(0,o.jsxs)("div",{className:(0,p.m)("flex flex-col items-center justify-center m-2 ".concat("Spotify"===s?"bg-green-800":"Youtube"===s?"bg-gray-500":"bg-orange-600"," p-2 rounded-md")),children:[(0,o.jsx)(y.default,{src:f.photo||F.default,alt:"Image",width:60,height:60,className:"rounded-full"}),(0,o.jsx)("p",{className:"text-center text-white",children:f.name})]}),1===c&&(0,o.jsx)(Z.Z,{className:(0,p.m)("w-[100px] bg-cyan-400 hover:bg-cyan-500"),onClick:()=>{m(2),u(f).then(e=>{e?b(e):b([])})},children:"Load Playlists"})]}):(0,o.jsx)("div",{className:(0,p.m)("flex flex-col items-center justify-center"),children:(0,o.jsx)("p",{children:"No user found"})}),2===c&&(0,o.jsx)("div",{className:(0,p.m)("flex flex-row items-center justify-center p-3"),children:x&&0!==x.length?(0,o.jsx)("div",{className:(0,p.m)("flex flex-col m-2 p-2 rounded-md"),children:(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsx)("h4",{className:"mb-4 text-sm font-medium leading-none",children:"Playlists"}),(0,o.jsx)("div",{className:"grid grid-cols-3 gap-4",children:x.map(e=>(0,o.jsx)(K.Z,{data:{id:e.id,title:e.name,image:e.image},image:e.image||F.default,onClick:()=>{console.log(e)}},e.id))})]})}):null===x?(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:"Loading Playlists..."}),(0,o.jsx)(w.c0,{})]}):(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:"No playlists found"}),(0,o.jsx)(Z.Z,{className:(0,p.m)("w-[100px] bg-cyan-400 hover:bg-cyan-500"),onClick:()=>u(j).then(e=>{e?b(e):b([]),console.log(e)}),children:"Retry"})]})}),(0,o.jsx)(y.default,{className:"object-cover",src:"Spotify"===s?"/images/logos/spot.svg":"Youtube"===s?"/images/logos/yt.svg":"/images/logos/soundcloud.png",alt:"Image",width:60,height:60})]})})},T=t(42368),D=t(47764),R=t(14148);let G=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2?arguments[2]:void 0;arguments.length>3&&arguments[3];try{let i=await (0,R.Z)(e,{headers:{Authorization:"Bearer ".concat(t)}});if((403===i.status||401===i.status)&&l>0)return G(e,l-1,t);return i}catch(e){throw console.error(e),e}},H=async()=>{let e=await (0,R.Z)("https://open.spotify.com/get_access_token?reason=transport&productType=web_player");return console.log(e),await e.json()},B=async(e,l)=>{let t=await G("https://api.spotify.com/v1/users/".concat(e,"/playlists"),1,l);return await t.json()},M=async(e,l)=>{let t=await G("https://api.spotify.com/v1/playlists/".concat(e,"/tracks"),1,l);return await t.json()};var W=()=>{let{onClose:e,isOpen:l,platform:t}=(0,T.uS)(),i=(0,D.xq)(),{spotProfile:s,setSpotProfile:a,spotPlaylists:d,setSpotPlaylists:u,addSpotPlaylist:c,updateSpotPlaylist:m,setYtPlaylists:v,updateScPlaylist:f,updateYtPlaylist:h,setScPlaylists:p}=(0,g.Oz)(),x=(0,n.useSupabaseClient)(),[y,b]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await x.auth.getSession();b(e)})()},[]),(0,r.useEffect)(()=>{console.log(y),(async()=>{if(y){var e;let{data:l,error:t}=await x.from("playlists").select("*").eq("user_id",null==y?void 0:null===(e=y.user)||void 0===e?void 0:e.id);if(t){console.error("Error fetching user playlists:",t);return}u(l.filter(e=>"Spotify"===e.platform)),v(l.filter(e=>"Youtube"===e.platform)),p(l.filter(e=>"Soundcloud"===e.platform));let i=[];for(let e of l){let l=await w(e.id);i.push(l),"Spotify"===e.platform?m(e.id,l):"Youtube"===e.platform?h(e.id,l):"Soundcloud"===e.platform&&f(e.id,l)}}})()},[y]);let j=async(e,l)=>{try{return await (0,V.yC)(e+" "+l,"video")}catch(e){return console.error("Error searching for song:",e),[]}};async function w(e){try{let{data:l,error:t}=await x.from("playlists_songs").select("song_id, song_order, yt").eq("playlistId",e).order("song_order",{ascending:!0});if(t){console.error("Error fetching songs in playlist:",t);return}let i=l.map(e=>e.song_id),{data:o,error:r}=await x.from("songs").select("*").in("id",i);if(r){console.error("Error fetching song details:",r);return}for(let e of o){let t=l.find(l=>l.song_id===e.id);e.yt=null==t?void 0:t.yt}return o.sort((e,t)=>{var i,o;let r=null===(i=l.find(l=>l.song_id===e.id))||void 0===i?void 0:i.song_order,s=null===(o=l.find(e=>e.song_id===t.id))||void 0===o?void 0:o.song_order;return(null!=r?r:0)-(null!=s?s:0)}),o}catch(e){console.error("Error fetching songs in playlist:",e)}}let N=async e=>{try{var l,t;let i=await (0,k.qC)({url:"/api/spotify/getProfile",data:{profile:e}});console.log(i);let{error:o}=await x.from("profiles").insert({profile_id:null==i?void 0:i.username,platform:"Spotify",user_id:null==y?void 0:null===(l=y.user)||void 0===l?void 0:l.id,username:null==i?void 0:i.username,image:null==i?void 0:i.photo});return a({platform:"Spotify",user_id:null==y?void 0:null===(t=y.user)||void 0===t?void 0:t.id,username:null==i?void 0:i.username,image:null==i?void 0:i.photo}),i}catch(e){if(e)return alert(e.message)}},_=async l=>{try{let l=await H();console.log(l);let t=l.accessToken,i=await B(null==s?void 0:s.username,t);console.log(i);let o=await Promise.all(i.items.map(async l=>{var i,o,r,s;let{error:a}=await x.from("playlists").insert({id:null==l?void 0:l.id,platform:"Spotify",name:null==l?void 0:l.name,href:null==l?void 0:l.href,image:null==l?void 0:null===(i=l.images[0])||void 0===i?void 0:i.url,author:null==l?void 0:l.owner,user_id:null==y?void 0:null===(o=y.user)||void 0===o?void 0:o.id});if(a){console.error("Error inserting playlist:",a);return}console.log("Playlist inserted"),c({id:null==l?void 0:l.id,platform:"Spotify",name:null==l?void 0:l.name,href:null==l?void 0:l.href,image:null==l?void 0:null===(r=l.images[0])||void 0===r?void 0:r.url,author:null==l?void 0:l.owner,user_id:null==y?void 0:null===(s=y.user)||void 0===s?void 0:s.id});let n=await M(l.id,t),d=await Promise.all(n.items.map(async e=>{var t,i,o,r,s,a,n,d,u,c,m,v,f,h,p,g,y,b,w,N,_,S,C,k,P,E,Z,Y,O,I,A,U,q,z,L,F,V,K;let Q=await j(null==e?void 0:null===(t=e.track)||void 0===t?void 0:t.name,(null==e?void 0:null===(i=e.track)||void 0===i?void 0:i.artists)?null==e?void 0:null===(r=e.track)||void 0===r?void 0:null===(o=r.artists[0])||void 0===o?void 0:o.name:"");if(null==e?void 0:null===(s=e.track)||void 0===s?void 0:s.is_local){console.log("Local song",e);let{error:t}=await x.from("songs").insert({id:null==Q?void 0:null===(a=Q.results[0])||void 0===a?void 0:a.id,author:null==Q?void 0:null===(n=Q.results[0])||void 0===n?void 0:n.author,name:null==Q?void 0:null===(u=Q.results[0])||void 0===u?void 0:null===(d=u.title)||void 0===d?void 0:d.text,image:null==Q?void 0:null===(m=Q.results[0])||void 0===m?void 0:null===(c=m.thumbnails[0])||void 0===c?void 0:c.url,platform:"Youtube"});if(t){console.error("Error inserting song:",t);return}let{data:i,error:o}=await x.from("playlists_songs").select("*").filter("playlistId","eq",null==l?void 0:l.id);if(console.log("Current songs",null==i?void 0:i.length),o){console.error("Error getting current songs:",o);return}let r=i.length>0?i.length+1:1,{error:s}=await x.from("playlists_songs").insert({song_id:null==Q?void 0:null===(v=Q.results[0])||void 0===v?void 0:v.id,playlistId:null==l?void 0:l.id,yt:Q.results?Q.results[0]:{},song_order:r});if(s){console.error("Error inserting playlist song:",s);return}return{id:null==Q?void 0:null===(f=Q.results[0])||void 0===f?void 0:f.id,author:null==Q?void 0:null===(h=Q.results[0])||void 0===h?void 0:h.author,album:{},name:null==Q?void 0:null===(g=Q.results[0])||void 0===g?void 0:null===(p=g.title)||void 0===p?void 0:p.text,image:null==Q?void 0:null===(b=Q.results[0])||void 0===b?void 0:null===(y=b.thumbnails[0])||void 0===y?void 0:y.url,platform:"Youtube"}}{let{error:t}=await x.from("songs").insert({id:null==e?void 0:null===(w=e.track)||void 0===w?void 0:w.id,author:(null==e?void 0:null===(N=e.track)||void 0===N?void 0:N.artists)?e.track.artists[0]:[],album:null==e?void 0:null===(_=e.track)||void 0===_?void 0:_.album,name:null==e?void 0:null===(S=e.track)||void 0===S?void 0:S.name,image:null==e?void 0:null===(P=e.track)||void 0===P?void 0:null===(k=P.album)||void 0===k?void 0:null===(C=k.images[0])||void 0===C?void 0:C.url,platform:"Spotify"}),{data:i,error:o}=await x.from("playlists_songs").select("*").filter("playlistId","eq",null==l?void 0:l.id);if(console.log("Current songs",null==i?void 0:i.length),o){console.error("Error getting current songs:",o);return}let r=i.length>0?i.length+1:1,{error:s}=await x.from("playlists_songs").insert({song_id:null==e?void 0:null===(E=e.track)||void 0===E?void 0:E.id,playlistId:null==l?void 0:l.id,yt:Q.results?{id:null==Q?void 0:null===(Z=Q.results[0])||void 0===Z?void 0:Z.id,author:null==Q?void 0:null===(Y=Q.results[0])||void 0===Y?void 0:Y.author,album:{},name:null==Q?void 0:null===(I=Q.results[0])||void 0===I?void 0:null===(O=I.title)||void 0===O?void 0:O.text,image:null==Q?void 0:null===(U=Q.results[0])||void 0===U?void 0:null===(A=U.thumbnails[0])||void 0===A?void 0:A.url,platform:"Youtube"}:{},song_order:r});if(s){console.error("Error inserting playlist song:",s);return}return{...e.track,platform:"Spotify",yt:Q.results?{id:null==Q?void 0:null===(q=Q.results[0])||void 0===q?void 0:q.id,author:null==Q?void 0:null===(z=Q.results[0])||void 0===z?void 0:z.author,album:{},name:null==Q?void 0:null===(F=Q.results[0])||void 0===F?void 0:null===(L=F.title)||void 0===L?void 0:L.text,image:null==Q?void 0:null===(K=Q.results[0])||void 0===K?void 0:null===(V=K.thumbnails[0])||void 0===V?void 0:V.url,platform:"Youtube"}:{}}}})),u={...l,songs:d};return console.log("Playlist",u),e(),u}));return console.log(o),d}catch(e){if(e)return alert(e.message)}};return(0,o.jsx)(Q,{profile:i,onClose:e,isOpen:l,platform:t,handleSearchUser:N,handleGetPlaylists:_})},J=()=>{let{onClose:e,isOpen:l,platform:t}=(0,T.$3)(),i=(0,D.UK)(),{ytPlaylists:s,setYtPlaylists:a,addYtPlaylist:d,setYtProfile:u}=(0,g.Oz)(),c=(0,n.useSupabaseClient)(),[m,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await c.auth.getSession();v(e)})()},[]);let f=async e=>{try{var l,t;let i=await (0,k.qC)({url:"/api/youtube/getProfile",data:{profile:e}});console.log(i);let{error:o}=await c.from("profiles").insert({profile_id:null==i?void 0:i.externalId,platform:"Youtube",user_id:null==m?void 0:null===(l=m.user)||void 0===l?void 0:l.id,username:null==i?void 0:i.username,image:null==i?void 0:i.photo});return u({profile_id:null==i?void 0:i.externalId,platform:"Youtube",user_id:null==m?void 0:null===(t=m.user)||void 0===t?void 0:t.id,username:null==i?void 0:i.username,image:null==i?void 0:i.photo}),i}catch(e){if(e)return alert(e.message)}},h=async e=>{try{let l=await (0,k.qC)({url:"/api/youtube/getProfile/getPlaylists",data:{profile:e.externalId}});console.log(l);let t=await (0,V.mr)(e.externalId);return console.log("Channel",t.current_tab.content.contents[0].contents),console.log("Profile",t.metadata),await Promise.all(t.current_tab.content.contents[0].contents.filter(e=>"Created playlists"===e.title.text)[0].content.items.map(async e=>{var l,i,o,r;let s=await (0,V.A5)(e.id),{error:a}=await c.from("playlists").insert({id:e.id,platform:"Youtube",name:null===(l=e.title)||void 0===l?void 0:l.text,href:"https://www.youtube.com/playlist?list=".concat(e.id),image:null===(i=e.thumbnails[0])||void 0===i?void 0:i.url,author:{name:t.metadata.title,id:t.metadata.externalId,image:t.metadata.avatar[0].url},user_id:null==m?void 0:m.user.id});a&&console.log("Error",a),await Promise.all(s.map(async l=>{var t,i,o,r;let{error:s}=await c.from("songs").insert({id:l.id,author:{id:null===(t=l.author)||void 0===t?void 0:t.id,name:null===(i=l.author)||void 0===i?void 0:i.name},album:{},name:null===(o=l.title)||void 0===o?void 0:o.text,image:null===(r=l.thumbnails[0])||void 0===r?void 0:r.url,platform:"Youtube"});s&&console.log("Error",s);let{data:a,error:n}=await c.from("playlists_songs").select("*").filter("playlistId","eq",null==e?void 0:e.id);if(console.log("Current songs",null==a?void 0:a.length),n){console.error("Error getting current songs:",n);return}let d=a.length>0?a.length+1:1,{error:u}=await c.from("playlists_songs").insert({playlistId:e.id,song_id:l.id,song_order:d});u&&console.log("Error",u)}));let n={id:e.id,platform:"Youtube",name:null===(o=e.title)||void 0===o?void 0:o.text,href:"https://www.youtube.com/playlist?list=".concat(e.id),image:null===(r=e.thumbnails[0])||void 0===r?void 0:r.url,author:{name:t.metadata.title,id:t.metadata.externalId,image:t.metadata.avatar[0].url},user_id:null==m?void 0:m.user.id,songs:s};console.log(n)})),l}catch(e){if(e)return alert(e.message)}};return(0,o.jsx)(Q,{profile:i,onClose:e,isOpen:l,platform:t,handleSearchUser:f,handleGetPlaylists:h})},X=t(86440),$=()=>{let{onClose:e,isOpen:l,platform:t}=(0,T.rw)(),i=(0,D.xe)(),{scKey:s,setScKey:a}=(0,g.Jt)(),{scProfile:d,setScProfile:u,setSpotProfile:c,setYtProfile:m}=(0,g.Oz)(),v=(0,n.useSupabaseClient)(),[f,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{let{data:{session:e}}=await v.auth.getSession();h(e)})()},[]),(0,r.useEffect)(()=>{f&&(async()=>{var e;let{data:l,error:t}=await v.from("profiles").select("*").eq("user_id",null==f?void 0:null===(e=f.user)||void 0===e?void 0:e.id);if(t){console.error("Error getting profiles:",t);return}console.log("Profiles",l),l.map(e=>{"Soundcloud"===e.platform?u(e):"Youtube"===e.platform?m(e):"Spotify"===e.platform&&c(e)}),console.log("Profiles",l)})()},[f]);let p=async e=>{try{if(console.log(s),null!==s){var l;let t=await (0,X.B6)(e,s),i=t.response;console.log(t),t.newKey&&t.newKey!==s&&(console.log("Setting new key"),a(t.newKey));let o=await (0,X._u)(i.avatar_url);console.log(i);let r={...i,photo:o,name:i.username},{error:n}=await v.from("profiles").insert({profile_id:i.id,platform:"Soundcloud",user_id:null==f?void 0:null===(l=f.user)||void 0===l?void 0:l.id,username:i.username,image:o});return n&&console.log("Error",n),u(r),r}return{}}catch(e){if(e)return alert(e.message)}},x=async e=>{try{if(null!==s&&null!==d){console.log("Value",e);let l=null,t=[],i=0;do{console.log("Offset",i);let e=await (0,X.Yl)(d.id,s,i);console.log(e),t=[...t,...e.collection],console.log(e.collection),l=e.next_href,i+=10}while(l);return t.map(async e=>{var l,t,i,o;let r=await (0,X._u)((null==e?void 0:e.artwork_url)?e.artwork_url:null==e?void 0:null===(l=e.tracks[0])||void 0===l?void 0:l.artwork_url),{error:s}=await v.from("playlists").insert({id:null==e?void 0:e.id,platform:"Soundcloud",name:null==e?void 0:e.title,href:null==e?void 0:e.permalink_url,image:r,author:{name:null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.username,id:null==e?void 0:null===(i=e.user)||void 0===i?void 0:i.id,image:null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.avatar_url},user_id:null==f?void 0:f.user.id});s&&console.log("Error",s),e.tracks.map(async l=>{var t,i,o,r;let{error:s}=await v.from("songs").insert({id:null==l?void 0:l.id,author:{name:null==l?void 0:null===(t=l.user)||void 0===t?void 0:t.username,id:null==l?void 0:null===(i=l.user)||void 0===i?void 0:i.id,image:null==l?void 0:null===(o=l.user)||void 0===o?void 0:o.avatar_url},name:null==l?void 0:l.title,image:null==l?void 0:l.artwork_url,media:{transcodings:null==l?void 0:null===(r=l.media)||void 0===r?void 0:r.transcodings,track_authorization:null==l?void 0:l.track_authorization},platform:"Soundcloud"});s&&console.log("Error",s);let{data:a,error:n}=await v.from("playlists_songs").select("*").filter("playlistId","eq",null==e?void 0:e.id);if(console.log("Current songs",null==a?void 0:a.length),n){console.error("Error getting current songs:",n);return}let d=a.length>0?a.length+1:1,{error:u}=await v.from("playlists_songs").insert({playlistId:e.id,song_id:l.id,song_order:d});u&&console.log("Error",u)})}),console.log(t),t}}catch(e){if(e)return alert(e.message)}};return(0,o.jsx)(Q,{profile:i,onClose:e,isOpen:l,platform:t,handleSearchUser:p,handleGetPlaylists:x})},ee=e=>{let{products:l}=e,[t,i]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{i(!0)},[]),t)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(_,{}),(0,o.jsx)(f,{}),(0,o.jsx)(O,{products:l}),(0,o.jsx)(L,{}),(0,o.jsx)(W,{}),(0,o.jsx)(J,{}),(0,o.jsx)($,{})]}):null}},37831:function(e,l,t){"use strict";var i=t(57437),o=t(75942);l.default=e=>{let{children:l}=e;return(0,i.jsx)(o.dV,{children:l})}},38462:function(e,l,t){"use strict";var i=t(57437),o=t(2265),r=t(64392),s=t(34728);l.default=e=>{let{children:l}=e,[t]=(0,o.useState)(()=>(0,r.createClientComponentClient)());return(0,i.jsx)(s.SessionContextProvider,{supabaseClient:t,children:l})}},63901:function(e,l,t){"use strict";var i=t(57437),o=t(88726);l.default=()=>(0,i.jsx)(o.x7,{toastOptions:{style:{background:"#333",color:"#fff"}}})},39311:function(e,l,t){"use strict";var i=t(57437),o=t(89362);l.default=e=>{let{children:l}=e;return(0,i.jsx)(o.Di,{children:l})}},58877:function(){}},function(e){e.O(0,[7092,2420,6115,9450,1787,9982,5722,3712,8447,8061,2400,8077,7057,71,8089,8871,3273,2971,7023,1744],function(){return e(e.s=14986)}),_N_E=e.O()}]);